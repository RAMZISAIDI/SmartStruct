# ๐๏ธ SmartStruct v7.1 Pro โ ุฏููู ุงููุดุฑ ูุงูุฅุนุฏุงุฏ

## ๐ ูููู ุงููููุงุช (ููุนุงุฏ ููููุชู)

```
SmartStruct/
โโโ index.html              โ ุงูุชุทุจูู ุงูุฑุฆูุณู (ูุธูู ูููุฑุชููุจ)
โโโ admin-login.html        โ ููุญุฉ ุชุญูู ุงููุณุคูู
โโโ supabase-db.js          โ ูุญุฑู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ููุตุญููุญ)
โโโ supabase-schema.sql     โ ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช PostgreSQL
โโโ README.md               โ ูุฐุง ุงูุฏููู
โโโ css/
โ   โโโ main.css            โ ุฌููุน ุงูุฃููุงุท (ูุณุชุฎุฑุฌุฉ ูู index.html)
โโโ js/
    โโโ app.js              โ ููุทู ุงูุชุทุจูู ุงููุงูู
    โโโ emailjs-config.js   โ ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
```

---

## โ ุงูุฃุฎุทุงุก ุงูุชู ุชู ุชุตุญูุญูุง (v7.1.1)

| ุงููุดููุฉ | ุงูุญู |
|---------|------|
| `SUPABASE_HARDCODED` ูุนุฑููู ูุฑุชูู (index.html + supabase-db.js) | ุฃูุฒูู ูู index.htmlุ ุฃูุถูู `proxy` ูู supabase-db.js ููุชูุงูู |
| `DBHybrid._supabaseUrl` ู `_supabaseKey` ุบูุฑ ููุฌูุฏููู | ุฃูุถููุง ูู supabase-db.js |
| `_sanitizeRecord` ูุญุชูู ุฎุทุฃ ูู ูุทุงู ุงููุชุบูุฑุงุช (variable scope bug) | ุฏููุฌ ูุน `cleanForSupabase` ูู ุฏุงูุฉ ูุงุญุฏุฉ |
| `SB_SCHEMA` ู `cleanForSupabase` ูุนุฑูููุชุงู ูุฑุชูู | ุงููุตุฏุฑ ุงูููุญูุฏ ุงูุขู ูู supabase-db.js (app.js ููุนูุฏ ุชุนุฑูููุง ูุงุญูุงู) |
| ูุง ููุฌุฏ `AbortController` timeout ูู ุจุนุถ ุงูุทูุจุงุช | ุฃูุถูู timeout (12 ุซุงููุฉ) ูุฌููุน ุทูุจุงุช REST |
| `_processSyncQueue` ููุณ ููุง ุญูุงูุฉ ูู ุงูุชุดุบูู ุงููุชุฒุงูู | ุฃูุถูู `finally` ูุถูุงู ุชุญุฑูุฑ `_syncing` ุฏุงุฆูุงู |
| ููู index.html ุถุฎู (13000 ุณุทุฑ) ูุตุนุจ ุตูุงูุชู | CSS ูููุตู ูู `css/main.css`ุ JS ูููุตู ูู `js/app.js` |
| `getSupabaseConfig` ูู app.js ุชูุดูุฑ ูู `SUPABASE_HARDCODED` | ุฃูุถูู shim ููุชูุงูู |

---

## ๐ ุงููุดุฑ ุงูุณุฑูุน

1. ุงุฑูุน **ุงููุฌูุฏ ูุงููุงู** ููุง ูู ุนูู ุฃู ุงุณุชุถุงูุฉ
2. ูุนูู ููุฑุงู ูู **ูุถุน Offline** (ุจูุงูุงุช ูู localStorage)

> โ๏ธ ูุง ุชุฑูุน ุงููููุงุช ุจุดูู ูููุตู โ ุงูุจููุฉ ูููุฉ (index.html ูุญุชุงุฌ `css/main.css` ู `js/app.js`)

---

## โ๏ธ ุชูุนูู Supabase

### ุงูุฎุทูุฉ 1 โ ุฅูุดุงุก ูุดุฑูุน
ุงุฐูุจ ุฅูู [supabase.com](https://supabase.com) ูุฃูุดุฆ ูุดุฑูุนุงู ูุฌุงููุงู.

### ุงูุฎุทูุฉ 2 โ ุชุดุบูู Schema
ูู ููุญุฉ Supabase: `SQL Editor` โ ุงูุณุฎ ูุญุชูู `supabase-schema.sql` ูุดุบููู.

### ุงูุฎุทูุฉ 3 โ ุฅุฏุฎุงู ุงูููุงุชูุญ
**ุฎูุงุฑ A (ุงูุฃุณูู):** ูู ุงูุชุทุจูู โ ุงูุฅุนุฏุงุฏุงุช โ Supabase โ ุฃุฏุฎู URL ู Key

**ุฎูุงุฑ B (ูุถููู ูู ุงูููุฏ):** ุงูุชุญ `supabase-db.js` ูุนุฏูู ุงูุณุทุฑูู 14-15:
```javascript
const SUPABASE_URL = 'https://xxxx.supabase.co';   // โ ุถุน URL ููุง
const SUPABASE_KEY = 'eyJhbGci...';                  // โ ุถุน Key ููุง
```

---

## ๐ ูุธุงู ุงูุงุชุตุงู ุงูุฐูู

- **Heartbeat** โ ping ูู 30 ุซุงููุฉ
- **Auto-reconnect** โ Exponential Backoff: 5ุซ โ 10ุซ โ 20ุซ โ ... โ ุฏูููุชูู
- **Network Events** โ ูุชูุงุนู ูุน online/offline ููุฑุงู
- **Page Visibility** โ ุนูุฏ ุนูุฏุฉ ุงูุชุจููุจ ูุชุญูู ูู ุงูุงุชุตุงู
- **Sync Queue** โ ุงูุจูุงูุงุช ุงูููุฏุฎููุฉ ุฃุซูุงุก ุงูุงููุทุงุน ูุง ุชุถูุน

---

## ๐ ุจูุงูุงุช ุงูุฏุฎูู ุงูุงูุชุฑุงุถูุฉ

### ููุญุฉ ุงูุฅุฏุงุฑุฉ (`admin-login.html`)
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| ุงูุจุฑูุฏ | `admin@smartbtp.dz` |
| ูููุฉ ุงููุฑูุฑ | `Admin@SmartStruct2025` |
| ููุชุงุญ ุงูุฃูุงู | `SSTR-ADMIN-2025` |

### ุญุณุงุจ ุชุฌุฑูุจู (ุงูุชุทุจูู ุงูุฑุฆูุณู)
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| ุงูุจุฑูุฏ | `demo@algerie-construction.dz` |
| ูููุฉ ุงููุฑูุฑ | `Demo@1234` |

---

## ๐๏ธ ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (16 ุฌุฏูู)

`plans` ยท `tenants` ยท `users` ยท `projects` ยท `workers` ยท `equipment` ยท `transactions` ยท `attendance` ยท `materials` ยท `stock_movements` ยท `invoices` ยท `salary_records` ยท `kanban_tasks` ยท `documents` ยท `obligations` ยท `notes`

---

## โ๏ธ ูููุทูุฑูู

### ุฅุถุงูุฉ ุฌุฏูู ุฌุฏูุฏ
1. ุฃุถู ุงูุฌุฏูู ูู `supabase-schema.sql`
2. ุฃุถู ุฃุนูุฏุชู ูู `SB_SCHEMA` ุจู `supabase-db.js` (ุงูุณุทุฑ ~96)
3. ุฃุถู ุญููู ุงูุชูุงุฑูุฎ ูู `SB_DATE_FIELDS` (ุงูุณุทุฑ ~121)
4. ุฃุถู ุญููู ุงูุฃุฑูุงู ูู `SB_NUM_FIELDS` (ุงูุณุทุฑ ~133)

### ุชุบููุฑ ูุฏุฉ ุงูู Heartbeat
ูู `supabase-db.js` โ `DBHybrid._heartbeatInterval` (ุงูุงูุชุฑุงุถู: 30000ms)

---

SmartStruct v7.1.1 Pro โ ูุตูู ููุดุฑูุงุช ุงูุฌุฒุงุฆุฑูุฉ ูู ูุทุงุน ุงูุจูุงุก ูุงูููุงููุงุช
