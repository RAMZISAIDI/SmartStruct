<!DOCTYPE html>
<html lang="ar" dir="rtl" id="htmlRoot">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SmartStruct v7.1 Pro â€” Ù…Ù†ØµØ© Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ù…Ù‚Ø§ÙˆÙ„Ø© Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠØ©</title>
<meta name="description" content="SmartStruct â€” Ù…Ù†ØµØ© Ø°ÙƒÙŠØ© Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„Ù…Ù‚Ø§ÙˆÙ„Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&family=JetBrains+Mono:wght@400;600;700&display=swap">
<link rel="stylesheet" href="css/main.css">
</head>
<body>

<div id="app">
  <div id="appLoader" style="position:fixed;inset:0;background:#060A10;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;font-family:'Tajawal',sans-serif;">
    <div style="width:52px;height:52px;border:3px solid rgba(232,184,75,0.2);border-top-color:#E8B84B;border-radius:50%;animation:spin 0.8s linear infinite;margin-bottom:1.2rem;"></div>
    <div style="color:#E8B84B;font-size:1.1rem;font-weight:700">SmartStruct</div>
    <div style="color:#4A5B7A;font-size:0.8rem;margin-top:0.3rem" id="loaderStatus">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    <style>@keyframes spin{to{transform:rotate(360deg)}}</style>
  </div>
</div>

<div class="toast-container" id="toastContainer"></div>

<button class="ai-fab" id="aiFab" onclick="SmartAI.toggleChat()" title="SmartAI" style="display:none">
  ğŸ¤–<span class="ai-fab-badge" id="aiFabBadge" style="display:none">!</span>
</button>
<div class="ai-chat-panel" id="aiChatPanel" style="display:none">
  <div class="ai-chat-header">
    <div class="ai-chat-avatar">ğŸ¤–</div>
    <div>
      <div class="ai-chat-name">SmartAI â€” Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ</div>
      <div class="ai-chat-status"><span class="ai-status-dot"></span>Ù…ØªØµÙ„ â€” ÙŠØ¹Ù…Ù„ Ø¨Ù€ Claude AI</div>
    </div>
    <button class="ai-chat-close" onclick="SmartAI.toggleChat()">âœ•</button>
  </div>
  <div class="ai-chat-messages" id="aiMessages"></div>
  <div class="ai-quick-btns" id="aiQuickBtns">
    <button class="ai-quick-btn" onclick="SmartAI.quickAsk('Ø­Ù„Ù‘Ù„ Ù…Ø´Ø§Ø±ÙŠØ¹ÙŠ ÙˆØ£Ø¹Ø·Ù†ÙŠ ØªÙˆØµÙŠØ§Øª')">ğŸ“Š ØªØ­Ù„ÙŠÙ„</button>
    <button class="ai-quick-btn" onclick="SmartAI.quickAsk('Ù…Ø§ Ù‡ÙŠ Ø£Ø¨Ø±Ø² Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…Ø§Ù„ÙŠØ©ØŸ')">âš ï¸ Ù…Ø®Ø§Ø·Ø±</button>
    <button class="ai-quick-btn" onclick="SmartAI.quickAsk('ØªÙˆÙ‚Ø¹ Ø±Ø¨Ø­ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±')">ğŸ’° ØªÙˆÙ‚Ø¹Ø§Øª</button>
    <button class="ai-quick-btn" onclick="SmartAI.quickAsk('Ù…Ø§Ø°Ø§ ÙŠØ¬Ø¨ Ø£Ù† Ø£ÙØ¹Ù„ Ø§Ù„Ø¢Ù†ØŸ')">ğŸ¯ Ø£ÙˆÙ„ÙˆÙŠØ§Øª</button>
  </div>
  <div class="ai-chat-input-wrap">
    <textarea class="ai-chat-input" id="aiInput" placeholder="Ø§Ø³Ø£Ù„ SmartAI Ø¹Ù† Ù…Ø´Ø§Ø±ÙŠØ¹Ùƒ..." rows="1"
      onkeydown="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();SmartAI.send()}"
      oninput="this.style.height='auto';this.style.height=this.scrollHeight+'px'"></textarea>
    <button class="ai-send-btn" id="aiSendBtn" onclick="SmartAI.send()">â¤</button>
  </div>
</div>

<!-- EmailJS (Ø®ÙÙŠÙ ~30KB) â€” ÙŠÙØ­Ù…ÙÙ‘Ù„ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"
  onerror="window._emailjsError=true;console.warn('EmailJS CDN unavailable')"></script>
<script>
if (typeof emailjs !== 'undefined') emailjs.init({ publicKey: 'hn_PRTs7PuJAgrrDp' });

// â•â•â•â• Lazy Loader â€” Chart.js Ùˆ jsPDF ØªÙØ­Ù…ÙÙ‘Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø© ÙÙ‚Ø· â•â•â•â•
window.loadChartJS = function() {
  return new Promise(function(resolve) {
    if (typeof Chart !== 'undefined') { resolve(); return; }
    var s = document.createElement('script');
    s.src = 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js';
    s.onload = resolve;
    s.onerror = function() { console.warn('Chart.js not available'); resolve(); };
    document.head.appendChild(s);
  });
};

window.loadJsPDF = function() {
  return new Promise(function(resolve) {
    if (typeof window.jspdf !== 'undefined') { resolve(); return; }
    var s1 = document.createElement('script');
    s1.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
    s1.onerror = function() { console.warn('jsPDF not available'); resolve(); };
    s1.onload = function() {
      var s2 = document.createElement('script');
      s2.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js';
      s2.onload = resolve;
      s2.onerror = resolve;
      document.head.appendChild(s2);
    };
    document.head.appendChild(s1);
  });
};
</script>

<!-- Ù…Ù„ÙØ§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø­Ù„ÙŠØ© (ØªØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª) -->
<script src="supabase-db.js"></script>
<script src="js/emailjs-config.js"></script>
<script src="js/app.js"></script>


<!-- Supabase Connection Badge -->
<div id="sbConnBadge" style="position:fixed;bottom:12px;left:12px;z-index:9999;padding:8px 10px;border-radius:12px;font:600 12px/1.2 Tajawal,system-ui;background:#111;color:#fff;box-shadow:0 8px 20px rgba(0,0,0,.18);display:none"></div>

</body>
</html>
